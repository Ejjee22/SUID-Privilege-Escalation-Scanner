# Author: Oscar Guerra RodrÃ­guez
# Github: https://github.com/Ejjee22

#!/bin/bash

function ctrl_c(){
  echo -e "\n\n[!] Saliendo ...\n"
  exit 1
  tput cnorm
}

# Ctrl + C
trap ctrl_c SIGINT
if ! [[ -f gtfobins.html ]]; then
  curl -s 'https://gtfobins.github.io/#' > gtfobins.html
fi

echo -e "\n[+] Checking binaries with SUID perm active\n"
commands="$(find / -perm -4000 2>/dev/null | awk 'NF{print$NF}' FS='/')"
echo "$commands"
echo -e "\n[+] Checking in gtfobins vulnerable binaries. The following binaries can be used for privilege escalation:\n"
echo "$commands" | while read command; do
  cat gtfobins.html | grep "/${command}/" | grep -q "SUID" 
  if [[ $? -eq 0 ]]; then 
    echo "[+] $command" 
  fi
done

tput cnorm
